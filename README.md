# Drill Core Processor

## Описание проекта

Проект предназначен для автоматизации процесса анализа геологических кернов. Он включает два основных этапа:

1. **Разметка данных**: Используется преобразование Хаффа для автоматического определения областей кернов на фотографиях ящиков и подготовки данных для обучения нейронной сети.
2. **Обучение нейронной сети**: Используется модель YOLOv8 для автоматической детекции областей кернов на новых изображениях.

---

## Структура проекта

```
drill-core-processor/
├── ProcessorData/
│   ├── output/
│   │   ├── images/
│   │   │   ├── train/         # Размеченные изображения для обучения
│   ├── labels/                # Аннотации в формате YOLO (если применимо)
├── DetectCoreSamples/
│   ├── data.yaml              # Конфигурационный файл YOLO
│   ├── main.py                # Скрипт для запуска обучения
```

---

## Этапы работы

### 1. Разметка данных

- Данные для обучения подготавливаются с использованием преобразования Хаффа.
- Разметка автоматически сохраняется в формате YOLO в папке `ProcessorData/output/images/train/`.

### 2. Обучение нейронной сети

- Для обучения используется YOLOv8 (модель "YOLOv8m").
- Настройка параметров обучения производится через файл `data.yaml`.

Пример содержимого `data.yaml`:
```yaml
train: ../ProcessorData/output/images/train
val: ../ProcessorData/output/images/train
nc: 1
names: ['core']
```

- Запуск обучения осуществляется через `main.py`:
```python
from ultralytics import YOLO

# Загрузка модели YOLOv8m
model = YOLO('yolov8m.pt')

# Тренировка модели
model.train(data='data.yaml', epochs=50, imgsz=1024, batch=16)

# Сохранение обученной модели
model.export(format='onnx')
```

---

## Результаты

### Обученная модель
- Модель сохраняется в папке `runs/detect/train/weights/best.pt`.
- Она может использоваться для детекции кернов на новых изображениях.

### Метрики модели
- **Precision**: 99.5%
- **Recall**: 98.4%
- **mAP@50**: 99.0%
- **mAP@50-95**: 59.9%

---

## Использование обученной модели

### Предсказание на новых изображениях

Пример использования обученной модели:
```python
from ultralytics import YOLO

# Загрузка обученной модели
model = YOLO('runs/detect/train/weights/best.pt')

# Предсказание на изображении
results = model.predict(source='/path/to/image.jpg', save=True, imgsz=1024)

# Визуализация результатов
results.show()
```

### Предсказание на папке изображений
```python
model.predict(source='/path/to/images', save=True)
```

---

## Зависимости

- Python >= 3.8
- ultralytics >= 8.0.0
- OpenCV
- NumPy
- pandas

Установить зависимости можно с помощью команды:
```bash
pip install -r requirements.txt
```

---
